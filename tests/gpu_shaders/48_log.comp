#version 450
// log â€” Element-wise natural logarithm
//
// out[i] = log(in[i])
//
// 2 bindings, 1 push constant (n)
layout(local_size_x = 256) in;

layout(set=0, binding=0) buffer Input  { float data[]; } inp;
layout(set=0, binding=1) buffer Output { float data[]; } out_;

layout(push_constant) uniform PC {
    float n;
} pc;

void main() {
    uint i = gl_GlobalInvocationID.x;
    uint N = uint(pc.n);

    if (i >= N) return;

    out_.data[i] = log(inp.data[i]);
}
