#version 450
// Matrix transpose kernel
// out[j * rows + i] = in[i * cols + j]
// Push constants: rows, cols
layout(local_size_x = 16, local_size_y = 16) in;

layout(set=0, binding=0) buffer Input  { float data[]; } input_buf;
layout(set=0, binding=1) buffer Output { float data[]; } output_buf;

layout(push_constant) uniform PC {
    float rows;
    float cols;
} pc;

void main() {
    uint i = gl_GlobalInvocationID.x;
    uint j = gl_GlobalInvocationID.y;
    uint rows = uint(pc.rows);
    uint cols = uint(pc.cols);

    if (i < rows && j < cols) {
        output_buf.data[j * rows + i] = input_buf.data[i * cols + j];
    }
}
