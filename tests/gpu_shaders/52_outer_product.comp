#version 450
// Outer product: C[i,j] = a[i] * b[j]
// a is m×1, b is n×1, C is m×n
layout(local_size_x = 16, local_size_y = 16) in;

layout(set=0, binding=0) buffer VecA   { float data[]; } a;
layout(set=0, binding=1) buffer VecB   { float data[]; } b;
layout(set=0, binding=2) buffer Matrix { float data[]; } c;

layout(push_constant) uniform PC {
    float m;
    float n;
} pc;

void main() {
    uint i = gl_GlobalInvocationID.x;
    uint j = gl_GlobalInvocationID.y;

    uint M = uint(pc.m);
    uint N = uint(pc.n);

    if (i < M && j < N) {
        c.data[i * N + j] = a.data[i] * b.data[j];
    }
}
