#version 450
// ecs_move â€” ECS movement system (GPU)
//
// Structure-of-Arrays layout:
//   positions_x[i], positions_y[i] = entity i position
//   velocities_x[i], velocities_y[i] = entity i velocity
//   active[i] = 1.0 if entity has both Position and Velocity components
//
// System: for each active entity, position += velocity * dt
//
// 5 bindings, 1 push constant (dt)
layout(local_size_x = 256) in;

layout(set=0, binding=0) buffer PosX    { float data[]; } pos_x;
layout(set=0, binding=1) buffer PosY    { float data[]; } pos_y;
layout(set=0, binding=2) buffer VelX    { float data[]; } vel_x;
layout(set=0, binding=3) buffer VelY    { float data[]; } vel_y;
layout(set=0, binding=4) buffer Active  { float data[]; } alive;
layout(push_constant) uniform PC { float dt; } pc;

void main() {
    uint i = gl_GlobalInvocationID.x;
    if (alive.data[i] != 1.0) return;

    pos_x.data[i] += vel_x.data[i] * pc.dt;
    pos_y.data[i] += vel_y.data[i] * pc.dt;
}
