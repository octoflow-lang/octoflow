#version 450
// clamp â€” Element-wise clamping to [low, high] range
//
// out[i] = clamp(in[i], low, high)
//
// 2 bindings, 3 push constants (n, low, high)
layout(local_size_x = 256) in;

layout(set=0, binding=0) buffer Input  { float data[]; } inp;
layout(set=0, binding=1) buffer Output { float data[]; } out_;

layout(push_constant) uniform PC {
    float n;
    float low;
    float high;
} pc;

void main() {
    uint i = gl_GlobalInvocationID.x;
    uint N = uint(pc.n);

    if (i >= N) return;

    float val = inp.data[i];
    out_.data[i] = clamp(val, pc.low, pc.high);
}
