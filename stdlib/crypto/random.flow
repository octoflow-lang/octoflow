// stdlib/crypto/random.flow â€” Random generation utilities
//
// Functions: random_float, random_int, random_hex, uuid_v4, random_token,
//            random_choice, random_shuffle

fn random_float(lo, hi)
  return lo + random() * (hi - lo)
end

fn random_int(lo, hi)
  return floor(lo + random() * (hi - lo + 1.0))
end

fn random_hex(length)
  let chars = "0123456789abcdef"
  let mut result = ""
  let mut i = 0.0
  while i < length
    let idx = floor(random() * 16.0)
    result = result + char_at(chars, idx)
    i = i + 1.0
  end
  return result
end

fn uuid_v4()
  // Generate UUID v4 format: xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx
  let h1 = random_hex(8.0)
  let h2 = random_hex(4.0)
  let h3 = "4" + random_hex(3.0)
  let y_chars = "89ab"
  let y = char_at(y_chars, floor(random() * 4.0))
  let h4 = y + random_hex(3.0)
  let h5 = random_hex(12.0)
  return h1 + "-" + h2 + "-" + h3 + "-" + h4 + "-" + h5
end

fn random_token(length)
  let chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
  let n = len(chars)
  let mut result = ""
  let mut i = 0.0
  while i < length
    let idx = floor(random() * n)
    result = result + char_at(chars, idx)
    i = i + 1.0
  end
  return result
end

fn random_choice(arr)
  let n = len(arr)
  let idx = floor(random() * n)
  return arr[idx]
end

fn random_shuffle(arr)
  let n = len(arr)
  let mut i = n - 1.0
  while i > 0.0
    let j = floor(random() * (i + 1.0))
    let tmp = arr[i]
    arr[i] = arr[j]
    arr[j] = tmp
    i = i - 1.0
  end
  return arr
end
